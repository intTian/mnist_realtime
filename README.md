# CNN手写数字识别

## 问题描述

利用卷积[神经网络](https://so.csdn.net/so/search?q=%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C&spm=1001.2101.3001.7020)将MNIST数据集的28×28像素的灰度手写数字图片识别为相应的数字。

## 数据描述

MNIST数据集是28×28像素的灰度手写数字图片，其中数字的范围从0到9

具体如下所示（参考自Tensorflow官方文档）：

train-images-idx3-ubyte.gz:训练集图片，55000张训练图片, 5000张验证图片

train-labels-idx1-ubyte.gz:训练集图片对应的数字标签

t10k-images-idx3-ubyte.gz:测试集图片，10000张图片

t10k-labels-idx1-ubyte.gz:测试集图片对应的数字标签

## 网络结构

### 输入层

将数据输入到神经网络中

输入层的结构是多维的 

MNIST数据集中是28×28像素的灰度图片 因此输入为28×28的二维矩阵

### 卷积层

使用卷积核提取特征

概念：

局部感受野： 类似滑动窗口 以窗口的范围去提取对应范围的神经元携带的特征

共享权值：对于同一个卷积核 权重是相同的 滑动过程中 权重不变

一个N×N的图像经过M×M的卷积核卷积后将得到（N-M+1）×（N-M+1）的输出。

卷积后输出的矩阵数据成为特征映射图，一个卷积核输出一个特征映射图，卷积操作是一种线性计算，因此通常在卷积后进行一次非线性映射。

### 激励层

激活函数 ReLU Sigmoid

映射到0-1之间 便于收敛 

### 池化层

池化层是将卷积得到的特征映射图进行稀疏处理，减少数据量，操作与卷积基本相似，不同的是卷积操作是一种线性计算，而池化的计算方法更多样化，一般有如下计算方式：

最大池化：取样池中的最大值作为池化结果

均值池化：取样池中的平均值作为池化结果

还有重叠池化、均方池化、归一化池化等方法。


### 全连接层

在网络的末端对提取后的特征进行恢复，重新拟合，减少因为特征提取而造成的特征丢失。

全连接层的神经元数需要根据经验和实验结果进行反复调参。

### 输出层

输出层用于将最终的结果输出，针对不同的问题，输出层的结构也不相同

例如MNIST数据集识别问题中，输出层为有10个神经元的向量 识别0-9

## 示例网络结构

### 模型结构

模型包括输入层

两个卷积层

两个池化层

全连接层

输出层

### 特征图输出大小计算公式

其中卷积和池化操作的特征图输出大小计算公式为：

![a3155bbbd0fb09abba3c8d2af25e76fe](https://i-blog.csdnimg.cn/blog_migrate/a3155bbbd0fb09abba3c8d2af25e76fe.png)

ImageWidth：图片宽度

Padding：边缘补齐像素数

KernelSize：卷积核宽度

Stride：移动步长

### 图示

具体模型结构如下图：

<img title="" src="https://i-blog.csdnimg.cn/blog_migrate/5a667e7cd8e715b6bfd18946f13f8b87.png" alt="5a667e7cd8e715b6bfd18946f13f8b87" data-align="center" style="zoom:67%;">








